# 24.处理错误

会有错误。人类制造了它们。人工智能也能制造它们——以及如何制造。错误可能令人恼火，也可能是灾难性的。

每个智能系统都应该有识别错误的策略；例如，通过监控关键指标并为用户提供简单的方法来报告问题。

每个智能系统也应该有一个处理错误的策略。也许这是通过更新智能来实现的；也许是通过让人类用手超越某些行为；也许是通过向受影响的用户提供变通办法或退款。

有些错误很难发现。有些将很难修复(不引入新的错误)。有些问题需要很长时间才能解决(部署新模型需要几个小时，提出新的情报策略需要几个月)。

本章将讨论处理错误的方法，包括以下主题:

*   系统可能犯的错误类型(尤其是严重的错误)。
*   智能可能出错的原因。
*   减少错误的方法。

智能系统的每个指挥者都应该接受错误的现实。

## 可能发生的最糟糕的事情

问问你自己:我的智能系统能做的最坏的事情是什么？

*   也许你的智能系统会犯一些小错误，比如闪烁一个用户不关心的灯或者播放一首他们不喜欢的歌。
*   也许它会浪费时间和精力，让用户不得不撤销的事情自动化，或者让你的用户把他们的注意力从他们真正关心的事情上移开，转而关注智能出错的事情。
*   也许它会花费你的商业资金，决定花费大量的 CPU 或带宽，或者不小心隐藏了你最好的(也是最赚钱的)内容。
*   也许它会让你面临法律风险，因为你在某个地方采取了违反法律的行动，或者关闭了客户或竞争对手的业务能力，给他们造成了你可能最终要承担责任的损害。
*   也许它会删除重要的东西，熔化熔炉，或者从一个用户向另一个用户发送攻击性的信息，从而造成不可挽回的伤害。
*   也许它会伤害到某人——甚至害死某人。

大多数时候，当你想到你的系统时，你会想到它会有多棒，它会做的所有好事，所有会喜欢它的人。你会想忽略它的问题；你甚至会试图忽略它们。

不要。

找出你的系统能做的最坏的事情。

然后找第二差的。

然后是第三差。

然后让另外五个人做同样的事情。拥抱并接受他们的想法。

然后，当你的智能系统可能会做十五件非常糟糕的事情时，问问你自己:这样可以吗？

因为这种类型的错误会发生，而且很难发现，也很难纠正。

如果你的系统可能做的最坏的事情糟糕到无法想象，你可能需要设计一个不同的系统——一个永远不会做那件坏事的系统，不管情报怎么说。也许你要确保一个人是决策过程的一部分。也许你用了一个不那么有力的经验。也许你会找到一些完全不同的事情去做…

因为智能会出错，最终，最糟糕的事情会发生。

## 智慧可以破解的方法

智能系统会因为许多不同的原因出错。有些是执行或管理问题；有些是智力问题。本节讨论这些潜在的问题来源，包括以下内容:

*   系统中断
*   模型中断
*   情报错误
*   智力退化

纠正错误的第一步是了解导致错误的原因。

### 系统中断

有时候电脑会死机。有时候网速很慢。有时网络电缆会被切断。有时一个系统在其系统交互的方式上有微妙的缺陷。这些是您的智能系统的实现或操作的问题，但是它们可能以与智能错误相同的方式出现在用户报告、升级和降级指标中。

在大型系统中隔离这些类型的问题可能很困难，特别是当智能在客户端(处于不同的升级状态)和多个服务器(可能位于不同的数据中心)之间传播时。

灾难性的停机通常很容易被发现——因为所有东西都坏了。但是部分停机可能更微妙。例如，假设 1%的流量流向一个特定的服务器，而这个服务器以一种疯狂的方式爆炸了。百分之一的用户有不好的体验，也许他们会一遍又一遍地报告……但这只是用户群的百分之一。99%的用户都不会为此烦恼。你会注意到吗？

系统中断应该很少发生，并且应该立即修复。如果它们变得普遍，它们将使情报工作瘫痪——而且它们将对士气造成明显的不利影响。

### 模型中断

与系统中断相关，模型中断与其说是一个智能问题，不如说是一个实现问题——但是它会有类似的症状。

模型中断可能发生在以下情况:

*   部署中的模型文件已损坏。
*   模型文件与将上下文转化为特性的代码不同步。
*   智能创建环境与智能运行时环境不同步。
*   智慧与经验不同步。

这些问题可能很难发现——想象一下，如果一些特性代码在智能创建环境中得到更新，而在智能运行时却没有。然后，当一个新的模型(使用更新的特性代码)被推送到运行时(使用过时的特性代码)时，它将被混淆。它会得到它没有预料到的特征值。它会犯错误。正因为如此，在运行时的精确度可能比在实验室时差 5%。实验室中的所有测试表明，智能运行良好，但用户的体验稍差。

因为这些问题很难发现，所以每个智能实现都应该进行检查和反复检查，以确保智能创建环境与运行时环境同步，所有东西都正确部署，并且所有组件都同步。

### 情报错误

当构成智能的模型与世界不完美匹配时(事实也确实如此)，就会出现错误。回想一下，创造智能是在学习一个可以代表问题的非常复杂的模型和学习一个可以很好地推广到新环境的模型之间的平衡行为。总会有差距——模型不太正确的地方。

这些差距会导致错误，这些错误很难通过智能创造来纠正。你可以尝试另一种类型的模型，但是那将会犯它自己的(新的)类型的错误。你可以得到更多的数据，但是回报是递减的。你可以尝试更多的特征工程——这通常会有帮助。但是这种类型的错误会一直存在。

它们会显得有点随机。它们将随着时间而改变(随着训练数据的改变)。纠正它们并不容易——这需要持续的努力，而且越深入越难。

情报错误的另一个挑战是找出情报的哪一部分负有责任。当模型松散耦合时(例如，当它们有一个执行顺序，并且第一个对上下文做出声明的模型获胜时)，很容易准确地确定哪个模型给出了不正确的答案。但是当模型紧密耦合时(例如，当几个模型的输出使用复杂的启发式或元模型组合时)，错误将更难跟踪。如果六个模型都要对一个错误负部分责任，你从哪里开始？

### 智力退化

当一个开放式的、随时间变化的问题发生变化时，你昨天拥有的智力将不如今天。改变问题会加剧一般的智能错误，因为即使你什么都不改变，新的错误也会发生。此外，针对“新”问题的训练数据需要时间来积累，这意味着您可能需要等待响应，并且您可能永远无法获得足够的训练数据来很好地了解问题的任何特定版本(当您了解它时，它已经不再相关)。

变化主要有两类:

1.  随着时间的推移，新的上下文出现(或者旧的上下文消失)，在这种情况下，您将需要创建新的智能来处理新的上下文，但是现有的训练数据仍然可以用于旧的上下文。
2.  在这种情况下，现有的训练数据可能会产生误导，您需要关注新的遥测技术来创建有效的情报。

了解智能系统退化的一种方法是保留旧版本的智能，并对当前数据运行一系列以前的智能——昨天、五天前、十天前的智能，等等。通过观察错误是如何变化的，你可以获得关于你的问题发展方式的直觉，并在选择如何适应时使用这种直觉。

## 减轻错误

随机的、低成本的错误是意料之中的。但是当错误激增，当它们变得系统化，或者当它们变得危险或昂贵时，您可能会考虑缓解。

本节讨论了以下减少错误的方法:

*   投资智能
*   平衡体验
*   调整智能管理参数
*   实施护栏
*   覆盖错误

### 投资智力

在一个健康的智能系统中，智能会不断提高。处理错误的一个方法是等待智能赶上来。

事实上，几乎所有其他减少错误的方法都降低了智能系统对于没有问题的用户的价值(通过淡化体验)；或者从长远来看，它增加了复杂性和维护成本(通过添加必须维护的手动调整)。因此，在可能的情况下，提高智力是处理错误的好方法。针对错误投资提高智力的最佳方式是:

1.  获取更多相关的遥测或训练数据，这些数据包含错误发生的环境。这可能允许智能创造开始用很少的工作来解决问题。
2.  通过将错误分类(根据本地人、年龄、用户属性等)并区分类别的优先级，帮助智能创建者区分他们花费时间的系统部分的优先级。然后，智能创造者可以致力于在这些特定领域有所帮助的特性和建模，可能通过划分和集中建模。
3.  在人员和工具方面为智能创造提供更多资源。

这些投资将提高情报的整体质量，随着时间的推移，水涨船高。

也许投资于智能的最糟糕的方式是跟踪智能错误，就像它们是软件缺陷一样，并让智能创造者负责依次修复它们，一个接一个，直到不再有任何错误。事情不是这样的。如果有您绝对必须修复的错误，那么您应该考虑本节中讨论的其他缓解方法之一。

### 平衡体验

如果错误是低级的、随机的智力错误或者是智力退化造成的，那么它们将很难解决。在这些情况下，你可能想要重新平衡体验，让它不那么强烈，让错误的代价更小。

如果问题足够糟糕，你可以考虑从本质上关闭智能体验，直到你能够解决问题。

有很多章节讨论了平衡智力和经验的方法，这里就不再赘述了。

### 调整智能管理参数

如果错误是由于退化——也就是说，因为新的上下文很快出现或者旧的上下文正在改变含义——您也许能够通过更快地训练和部署新的模型来解决它们。

你也可以改变你使用的训练数据，例如通过更快地逐步淘汰旧的训练数据(当上下文改变含义时)或在遥测或训练中上采样新的上下文(这有助于改变含义和当新的上下文快速出现时)。

这些方法类似于智力投资，但它们可能更加被动。例如，当一个假期来临，一个坏天气事件发生，或者一个新产品发布时，你的问题可能会比平常变化得更快。指挥者可能知道这一点，并调整一些旋钮，而不是等待智能创造者学习如何预测这些类型的事件。

### 实施护栏

有时你会遇到一些愚蠢的错误。任何人看到这个错误都会知道它不可能是对的。例如:

*   当颗粒烤架达到 800 度时，你绝不会想往火上添加更多的燃料。
*   当用户 10 岁时，你永远不会想给他们看恐怖电影。

在这些情况下，你可以尝试欺骗智能创造算法来学习这些东西。你可以收集有针对性的训练数据。你可以追踪智慧创造者。你可以投入几个月的工作…

或者，您可以实现一个简单的启发式方法，在智能将要做一些明显疯狂的事情(护栏)时覆盖它。

使用护栏时，确保:

1.  保守一点——只忽略显而易见的问题，不要被卷入手工创建复杂的智能。
2.  重新审视你的决定——通过跟踪护栏的性能(和成本),随着智能的提高或问题的改变，删除或放松那些变得不那么重要的护栏。

### 覆盖错误

有时候没有办法；您的系统会犯代价高昂的错误，这些错误无法通过任何其他方式来减轻，您必须手动覆盖这些错误。例如:

*   你运行一个搜索引擎，查询“游戏”的顶部响应不是关于游戏的。
*   你运行一个反垃圾邮件服务，它正在删除合法企业的所有邮件。
*   你运行一个电子商务网站，它删除了一个“违反政策”的产品，但该产品没有违反政策。
*   你运行一个有趣的网页搜索器，它将互联网上最受欢迎的笑话网站标记为不有趣。

当这些错误足够重要时，您可能希望有特殊的用户体验来允许用户报告问题。您可能需要一些流程来回应这些报告。例如，您可以创建一个支持小组，使用正确的工具和工作流程，在一小时内、一天 24 小时、一周 7 天检查每个报告的错误。

与护栏一样，确保谨慎使用覆盖，并跟踪覆盖的质量和成本。

## 摘要

错误是智能系统的一部分，你应该有一个计划来衡量和处理错误。这个计划的一部分是了解你的系统会做什么样的坏事。对自己诚实。在想象问题时要有创造性。

为了解决问题，了解导致问题的原因是很有帮助的。在以下情况下可能会出错:

*   你的智能系统有一部分断电了。
*   您的模型创建、部署或解释不正确。
*   你的智力与这个问题并不完全匹配(事实也的确如此)。
*   问题或用户群的变化。

一旦发现问题，您可以通过多种方式缓解它:

*   通过加大对智力的投资。
*   通过重新平衡体验。
*   通过改变智能管理参数。
*   通过安装护栏。
*   通过覆盖错误。

积极的错误缓解计划可以让您的智能系统的其余部分变得更积极，并实现更大的影响。拥抱错误，明智而有效地减少错误，是构建智能系统的重要组成部分。

## 供思考…

阅读完本章后，您应该:

*   了解错误何时以及如何给智能系统带来风险。
*   了解如何知道一个智能系统是否在工作，并识别它可能出现故障的常见方式。
*   能够使用一系列常用方法来减少错误，并知道何时使用各种方法。

你应该能够回答这样的问题:

*   你知道的最普遍的智能系统错误是什么？
*   最贵的是哪个？
*   设计一个系统来解决这两个错误中的一个(普遍的错误或昂贵的错误)。
*   对另一个错误有用吗？为什么或为什么不？