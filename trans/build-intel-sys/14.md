# 十四、情报管理

智能系统中的智能经历了一个从创建、验证、部署、为用户点亮，最后随着时间的推移被监控的过程。智能管理弥合了智能创建(将在本书的第四部分中讨论)和智能编排(将在第五部分中讨论)之间的差距，它使部署新的智能和为用户启用智能变得更加安全和容易。

最简单地说，智能管理可能包括将模型文件手动复制到一个部署目录中，运行时在该目录中获取模型文件并将其公开给用户。但是在大型复杂的智能系统中，管理智能的过程可能(也可能应该)更加复杂。

本章将讨论智能管理面临的一些挑战。然后，它将概述智能管理如何支持您的智能系统的敏捷性，同时验证智能并让用户了解它。

## 智能管理概述

情报管理包括从情报产生的地方获取情报，并将其放在会影响用户的地方的所有工作。这包括:

*   对智能进行健全性检查，以确保其正常运行。
*   将智能部署到它需要执行的运行时。
*   以可控的方式点亮智慧。
*   关闭不再有用的智能。

智能管理系统可以很简单(就像一组指令，智能操作员必须手动执行其中的每一步)；它可以是部分自动化的(就像一组完成工作的命令行工具)；或者它可以非常灵活(就像一个图形控制台，让智能编排者通过点击来注入、移动、点亮或禁用智能)。一个好的情报管理系统将完成以下任务:

*   提供足够的支持，以匹配您环境中的智能管理技能和场景。
*   让犯错变得困难。
*   不引入太多的延迟。
*   在人工参与和实现成本之间进行权衡。

由于复杂性、频率和人类系统，情报管理具有挑战性。我们将依次讨论这些。

### 智能管理的复杂性

智能系统可能相当复杂。例如:

*   智能可能需要位于客户端和服务器之间的多个位置，包括客户端智能、一个或多个服务器端智能和缓存智能。
*   情报可能来自几十个不同的来源，其中一些是机器学习的，一些是人类创造的，一些是由组织外部的流程创造的。
*   智力的各个部分可能相互依赖，并且可能由不同的人以不同的频率更新。

随着智能系统的不断发展，简单地将新的智能正确地部署到用户手中可能会很困难，而且容易出错。

### 情报管理中的频率

智能系统在其生命周期内会多次更新其智能，请考虑:

*   三年每周更新一次情报，大概是一百六十次。
*   三年每天更新一次情报，大概是一千次。
*   三年每小时更新一次情报，大概两万六千次。
*   三年来每分钟更新一次情报，大概是 150 万次。

这些都是相当大的数字。他们的意思是，情报管理过程需要可靠(错误率低)，而且很可能不需要太多的人力。

### 人类系统

智能可能由具有各种技能水平和背景的用户部署:

*   非常了解智能系统实现的专家。
*   不是伟大工程师的机器学习实践者。
*   手动纠正系统正在犯的代价高昂的错误的非技术人员。
*   新员工。
*   不满的员工。

让智能管理变得更简单、更不容易出错，可以让您的智能系统随着时间的推移不断发展，从而获得巨大的灵活性回报。

## 理智检查智能

快速、自动化的健全性检查系统是情报创造者的安全网，允许他们充满信心地创新，并将精力集中在构建更好的情报上(而不是交叉检查一堆细节和记住如何运行所有应该运行的测试)。一个有效的安全网将验证这一新的情报:

*   与智能系统兼容。
*   执行并满足任何运行时要求。
*   不会犯明显的错误。

一个好的情报管理系统在不进行这些检查的情况下部署情报要比通过一个自动进行这些检查的系统来部署情报更加困难。

我们现在将依次探讨这些检查类别。

### 检查兼容性

错误时有发生。有时，智能创建者将事情格式化错误，或者忘记对他们的模型文件运行转换器，或者从损坏的遥测文件训练模型，或者训练环境以奇怪的方式中断，输出损坏的模型。情报管理是一个很好的阻塞点，可以在许多简单、常见的错误演变成破坏性问题之前发现它们。以下是一些需要检查以确保智能兼容的事项:

*   智能数据文件已正确格式化，并将加载到智能运行时中。
*   新的智能与当前部署的特征提取器同步。
*   新智能与系统中的其他智能同步，或者从属智能同时部署。
*   新的智能部署包含所有必需的元数据(例如将其与智能体验挂钩所需的任何阈值)。
*   部署新智能的成本将是合理的(在带宽成本等方面)。

这些都是静态测试，应该易于自动化，不应该引入太多的延迟，并且不需要太多的人工监督(除非有问题)——很容易自动确定它们是通过还是失败。

### 检查运行时约束

检查新智能是否满足其执行环境的任何约束也很重要，包括:

*   新的智能在运行时加载到内存中时不会使用太多的 RAM。
*   新的智能满足了执行环境的运行时性能目标(跨广泛的上下文)。
*   当用户与其交互时，新智能的运行方式将与它在智能创建环境中的运行方式完全相同(上下文处理、功能创建、智能执行等)。

这些测试要求:

*   在测试环境中执行智能，该环境反映了用户将与智能交互的环境。
*   一种加载上下文、执行智能、测量资源消耗并将结果与已知正确答案进行比较的工具。
*   一组测试上下文，为用户遇到的站点提供良好的覆盖。

这些是可以自动化的动态测试。它们会引入一些延迟(取决于你使用多少测试环境)。它们不需要太多的人工监督(除非有问题)——很容易自动确定它们是通过还是失败。

### 检查明显的错误

智能创造者不应该创造会犯明显错误的智能。你可以告诉他们这一点(我将在本书的后面告诉他们)，但检查一下也无妨。情报管理应验证:

*   新的智能在验证集上具有“合理的”准确性(智能创造者永远看不到的上下文——没有作弊)。
*   新的智能不会在一组业务关键的上下文上犯任何错误(这应该永远不会错)。
*   新情报不会犯比以前情报代价更大的错误。
*   新的智能不会把它的新错误集中在任何关键的用户子群体或环境上。

如果这些测试中的任何一个失败，智能部署应该被暂停，以便由人工进行进一步的检查。

这些是可以自动化的动态测试。它们会引入一些延迟(取决于你使用多少测试环境)。它们有些主观，因为人类可能需要考虑准确性随时间波动的意义。

## 点亮智慧

一旦智能通过了一系列离线检查，就可以通过真实用户进行检查。实现这一点的方法包括以下几种:

*   单一部署
*   无声的智慧
*   受控展示
*   战斗的
*   恢复

本节将讨论这些方法以及它们的优缺点，以便您可以决定哪种方法适合您的智能系统。

### 单一部署

在最简单的情况下，智能可以通过以下几种方式同时部署到所有用户:

*   通过将新的智能捆绑到一个文件中，将该文件推送到客户机上的运行时，并覆盖旧的智能。
*   通过将新的智能复制到托管运行时的服务器上并重新启动运行时进程。
*   通过将智能划分为在客户端运行的部分、在服务上运行的部分和在后端运行的部分，并将正确的部分部署到正确的位置。

一次推出全部智能易于管理，实现起来也相对简单。但这并不十分宽容。如果有问题，您的所有用户都会立刻看到问题。

例如，想象你已经制造了一台智能洗衣机。放进衣服，关上门，这台机器就可以洗了——再也不用摆弄刻度盘和设置了。假设系统运行良好，但是您决定通过一次部署来提高智能。你向成千上万台智能洗衣机推出一种新的智能——然后开始收到洗衣机正在毁坏用户衣服的报告。这是怎么发生的？你不确定。但是这个问题正在影响你的所有用户，而你却没有一个好的解决方案。

在以下情况下，单一部署可能有效:

*   你想让事情变得简单。
*   您有很好的离线测试来捕捉问题。

在以下情况下，单一部署可能会有问题:

*   你的系统犯了代价高昂的错误。
*   你识别和纠正问题的能力有限/缓慢。

### 无声的智慧

Silent intelligence 将新智能与现有智能并行部署，并在每次交互时同时运行这两种智能。现有的智能用来控制智能体验(用户看到的)。无声智能不影响用户；它的预测简单地记录在遥测技术中，所以你可以检查它们，看看新的智能是否做得很好。

一个有用的技术是检查现有智能和沉默智能做出不同决策的环境。这些是新智能比旧智能更好或更差的地方。手动检查几百个这样的上下文可以给新智能打开是安全的(或者不是)很大的信心。

智能可以在静默模式下运行任意长的时间:一千次执行、几个小时、几天或几周；只要你对它有信心。

如果新的智能在无声评估期间证明了自己，就可以取代之前的智能。但是如果新的智能变得更差，它可以被删除而不会影响用户——没问题！

无声情报在以下情况下可能有效:

*   你想要对你的智力质量进行额外的检查。
*   您希望确认您的智能在运行时给出的答案与您创建它时的答案相同。
*   你有一个非常大的或开放式的问题，你想获得信心，你的智力将在新的和罕见的环境中表现良好(这可能不会出现在你的智力创造环境中)。

无声智能在以下情况下可能会有问题:

*   你不想要同时运行多个智能的复杂性(或资源成本)。
*   延迟是至关重要的，你不能等待在静默模式下验证你的新智能。
*   很难在不向用户公开的情况下评估静默智能的效果——你可以看到它会做什么，但不知道用户会得到什么结果。

### 受控展示

受控的首次展示为一小部分用户带来了新的智能，而让其余的用户使用旧的智能。它从新用户那里收集遥测数据，并使用它来验证新智能是否按预期执行。如果新智能好，就铺开给更多用户；如果新智能有问题，可以还原，不会造成太大伤害。

这在两个重要方面不同于无声智能:

1.  受控展示中的遥测技术包括智能对用户行为的影响。你可以知道智能做了什么和用户如何反应。
2.  受控展示为每个客户端运行一个智能；但是跨用户群运行多种智能—每个客户端使用的资源更少，但是管理起来可能更复杂。

可以使用各种策略来平衡延迟和安全性，包括:

*   只要遥测显示一切顺利，每隔几个小时就向一小部分用户推广。
*   推广到一个小的测试组几天，然后到每个人那里，只要没有发现问题。
*   向 alpha 测试者推广一段时间，然后是 beta 测试者，然后是早期采用者，最后是所有人。

在以下情况下，受控的首次展示会很有效:

*   你想看看用户会如何应对一个新的智能，同时控制新的智能可能造成的损害。
*   你愿意让你的一些用户经历问题来帮助你验证智能。

在以下情况下，受控的首次展示可能会有问题:

*   您不想处理同时部署多个智能版本的复杂性。
*   你担心罕见的事件。例如，对 1%的用户进行受控部署不太可能发现只影响 1%用户的问题。

### 战斗的

飞行是一种特殊类型的受控展示，它向不同的用户群体提供不同版本的智能，以回答关于智能的统计问题。

想象一下，两个智能创造者来到你面前，对你的智能系统说他们有更好的智能。其中一个智能是速度快，但准确性一般。另一个非常慢，但有更好的准确性。

在实现您的智能系统的目标方面，哪一个会做得更好？用户会更喜欢哪个？哪个会提高敬业度？哪个会带来更好的结果？

你可以组织焦点小组。你可以让智能创造者争论到底。见鬼，你可以给他们战斧，把它们放在竞技场里，让胜利者选择运送哪种智力…

或者，您可以将每个版本部署到 1000 名客户，并在接下来的一个月中跟踪他们的结果。

*   试验人群中的一方比另一方使用应用程序多吗？
*   一组试验人群比另一组得到了更好的结果吗？
*   有没有一个试验人群对你的应用程序的好感度比另一个高？

飞行可以帮助你理解智能如何与你的智能系统的其余部分相互作用以实现目标。

在以下情况下，飞行可能是有效的:

*   你正在考虑一些大的改变，你想知道哪一个是最好的。
*   您需要长期跟踪变化，这样您就可以对变化如何影响结果、领先指标和组织目标做出统计上有效的陈述。

在以下情况下，航班可能会出现问题:

*   你需要快速迭代，在短时间内做出很多改变。
*   您考虑的选项之间的差异很小(当一种算法比另一种算法精确 0.5%时)。航班可能需要很长时间来确定哪个小的变化是最好的。

## 关闭智能

不管你认为自己有多安全，有时事情会出错，你可能不得不撤销情报变更——要快！

做到这一点的一个方法是将旧的情报重新部署到一个行为不端的新情报上。

另一种方法是在运行时附近保存智能的多个版本——一个新版本和几个旧版本。如果出现问题，运行时可以加载以前的智能，而没有任何分发延迟(或成本)。

在以下情况下，支持快速恢复可能会很有效:

*   你是人(因此会犯错)。
*   部署智能的成本很高。

在以下情况下，对快速恢复的支持可能会有问题:

*   你试图给某人留下深刻印象，不想让他们认为你是个懦夫。
*   您的智能很大，并且您没有能力在运行时存储它的多个副本。

## 摘要

智能管理将智能从它被创建的地方带到它将影响用户的地方。一个好的管理系统将使部署智能变得非常容易，并使其难以出错。它必须做到以下两点:

*   理智检查智力；也就是说，执行基本检查以确保智能是可用的。这些包括确保它将在运行时运行，它将具有足够的性能，并且它不会犯明显的可怕错误。
*   点亮智能，包括控制智能以一种有分寸的方式呈现给用户，查看智能可能会做什么，查看一小部分用户与智能的交互，以及在出现问题时快速恢复智能。

一个成功的情报管理系统将使部署情报变得容易和有信心。

它将通过防止常见错误来帮助情报创造者，同时也让他们以一种有分寸的方式来验证他们的情报对真实用户的行为。

一个良好的情报管理系统将支持情报服务的运作。

## 供思考…

阅读完本章后，您应该:

*   能够设计一个系统来管理智能系统中的智能。
*   知道验证智能的方法，以确保它是兼容的，在约束内工作，并且不犯明显的错误。
*   准备好一系列安全推出智能变更的方法，确保智能正在做它想要做的事情。

你应该能够回答这样的问题:

*   为情报部门设计一个情报管理系统，其中情报每月都有变化。你会制造什么工具？你会创建什么样的工具来向用户展示智能？
*   现在想象一下，智力每天需要变化两次。你会有什么不同的做法？